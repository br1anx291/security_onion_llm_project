# security_onion_llm_project/enrichment_rules.yml


primary_evidence_map:
  # Từ khóa chung dựa trên giao thức
  "DNS": ["dns", "http", "ssl"]   
  "HTTP": ["http"]
  "JA3": ["ssl"]
  "NETBIOS": ["files", "dns"]
  "SMB": ["files", "dns"]
  "P2P": ["files", "dns"]
  "SSL": ["ssl"]
  "TLS": ["ssl", "dns"]
  "RAW TCP": ["files", "dns", "ssl"]
  "UPNP": ["http", "dns"]
  "SNMP": ["dns"]
  "STUN": ["dns", "files"]

  # Từ khóa cho các loại tấn công hoặc malware cụ thể
  # Đây là những quy tắc rất mạnh
  "WEB_SERVER": ["http"]
  "TROJAN": ["http", "dns", "files"]
  "MALWARE": ["http", "files", "dns", "ssl"]
  "RANSOMWARE": ["files", "smb"]
  "DRIDEX": ["ssl", "files"]
  "COBALT STRIKE": ["dns", "http"]
  "C2": ["dns", "http", "ssl"] # Command and Control
  "PHISHING": ["http", "dns", "ssl"]

  # MALWARE
  "HILOTI": ["http", "files", "dns"]
  

  # Từ khóa cho các hành vi đáng ngờ
  "SUSPICIOUS": ["dns", "http", "files", "ssl"]
  "EXECUTABLE": ["files", "http"]
  "POLICY": ["dns", "http", "ssl"]
  "PE ": ["files", "http"]

  # Cho các alert về P2P
  "BITTORRENT": ["files", "dns"] 
  "TORRENT": ["http", "files", "dns"]

  # Cho các alert về User-Agent
  "USER_AGENT": ["http"]
  "USER-AGENT": ["http"]
  "UA" : ["http"] 

  "TUNNEL": ["dns", "ssl"] # (cho DNS Tunneling)
  "SCAN": ["ssl", "dns"]
  "DROPBOX": ["files", "ssl", "dns"]
  
  "VULNERABLE": ["http", "files", "dns"]